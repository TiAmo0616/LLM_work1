# 产品需求文档（PRD）

## 项目名称
图片水印工具

## 项目背景
随着智能手机和数码相机的普及，用户拍摄的照片数量日益增多。为了方便用户标记照片的拍摄日期，开发一款命令行工具，能够自动读取图片的拍摄时间信息，并将其作为水印添加到图片上。

## 功能需求

### 核心功能
1. **读取图片文件路径**
   - 用户通过命令行输入一个图片文件路径。

2. **提取图片的EXIF信息**
   - 程序读取指定路径下所有图片文件的EXIF信息。
   - 提取拍摄时间信息，格式化为“年月日”（例如：2025年9月19日）。

3. **水印设置**
   - 用户可以通过命令行参数设置以下水印属性：
     - 字体大小
     - 字体颜色
     - 水印位置（例如：左上角、居中、右下角）。

4. **生成水印图片**
   - 程序将水印文本绘制到图片上。
   - 生成的新图片文件保存在原目录名加后缀`_watermark`的新目录下。
   - 新目录作为原目录的子目录。

### 非功能性需求
- 程序应支持常见图片格式（如JPEG、PNG）。
- 程序应具有良好的错误处理能力，例如：
  - 当路径无效时提示用户。
  - 当图片文件缺少EXIF信息时提示用户。
- 程序应具有良好的性能，能够快速处理大量图片。

## 用户交互

### 输入
- 用户通过命令行输入图片文件路径。
- 可选参数：
  - `--font-size`：设置字体大小（默认值：20）。
  - `--font-color`：设置字体颜色（默认值：黑色）。
  - `--position`：设置水印位置（默认值：右下角）。

### 输出
- 程序在命令行中输出处理进度和结果。
- 生成的图片文件保存在新目录中，目录结构如下：
  ```
  原目录/
  ├── 原图片1.jpg
  ├── 原图片2.jpg
  └── 原目录_watermark/
      ├── 原图片1.jpg
      └── 原图片2.jpg
  ```

## 技术实现

### 开发语言
- Python

### 依赖库
- `Pillow`：用于图片处理。
- `piexif`：用于读取和操作EXIF信息。
- `argparse`：用于解析命令行参数。

### 主要模块
1. **命令行参数解析模块**
   - 使用`argparse`解析用户输入的路径和可选参数。

2. **EXIF信息提取模块**
   - 使用`piexif`读取图片的EXIF信息。

3. **水印绘制模块**
   - 使用`Pillow`在图片上绘制水印。

4. **文件管理模块**
   - 创建新目录并保存处理后的图片文件。

## 验收标准
- 用户能够通过命令行成功运行程序。
- 程序能够正确读取图片的拍摄时间信息并生成水印。
- 程序生成的图片文件保存在正确的目录中。
- 程序能够处理用户输入的异常情况并给出友好的提示。

## 未来扩展
- 支持更多的水印样式（如图片水印）。
- 支持批量处理多个目录。
- 提供图形用户界面（GUI）。